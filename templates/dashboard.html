<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ARK Banking - Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <!-- Top Header -->
  <div class="top-header">
    <h1>ARK BANKING</h1>
    <div class="user-info">
      <span>Welcome, {{ user.firstName }} {{ user.lastName }}</span>
      <a href="{{ url_for('logout') }}" class="logout-link">Sign out</a>
    </div>
  </div>

  <!-- Navigation Tabs -->
  <nav class="nav-tabs">
    <div class="nav-tabs-container">
      <a href="{{ url_for('dashboard') }}" class="nav-tab active">Accounts</a>
      <a href="{{ url_for('transactions') }}" class="nav-tab">Transactions</a>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Secondary Navigation -->
    <div class="secondary-nav">
      <a href="#" class="secondary-nav-link active">Overview</a>
    </div>

    <!-- Alerts -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- Bank Accounts Section -->
    {% if accounts %}
      {% if accounts.checkingId %}
      <div class="account-card">
        <a href="#" class="account-name">ARK CHECKING (...{{accounts.checkingId[-4:]}})</a>
        
        <div class="balance-row">
          <div>
            <div class="balance-amount {% if accounts.checkingBalance >= 0 %}positive{% else %}negative{% endif %}">
              ${{ "%.2f"|format(accounts.checkingBalance) }}
            </div>
            <div class="balance-label">Available balance</div>
          </div>
        </div>

        <div class="account-actions">
          <a href="{{ url_for('deposit') }}" class="btn-primary">Deposit</a>
          <a href="{{ url_for('withdraw') }}" class="btn-secondary">Withdraw</a>
          {% if accounts.type == 'both' %}
          <a href="{{ url_for('transfer') }}" class="btn-secondary">Transfer</a>
          {% endif %}
        </div>
      </div>
      {% endif %}

      {% if accounts.savingsId %}
      <div class="account-card">
        <a href="#" class="account-name">ARK SAVINGS (...{{accounts.savingsId[-4:]}})</a>
        
        <div class="balance-row">
          <div>
            <div class="balance-amount {% if accounts.savingsBalance >= 0 %}positive{% else %}negative{% endif %}">
              ${{ "%.2f"|format(accounts.savingsBalance) }}
            </div>
            <div class="balance-label">Available balance</div>
          </div>
        </div>

        <div class="account-actions">
          <a href="{{ url_for('deposit') }}" class="btn-primary">Deposit</a>
          <a href="{{ url_for('withdraw') }}" class="btn-secondary">Withdraw</a>
          {% if accounts.type == 'both' %}
          <a href="{{ url_for('transfer') }}" class="btn-secondary">Transfer</a>
          {% endif %}
        </div>
      </div>
      {% endif %}
    {% else %}
      <div class="account-card">
        <p>No accounts found. Please contact support.</p>
      </div>
    {% endif %}

    <!-- Recent Transactions -->
    {% if transactions %}
    <div class="transactions-section">
      <h3>Recent Transactions</h3>
      {% for trans in transactions[:5] %}
      <div class="transaction-item">
        <div>{{ trans }}</div>
      </div>
      {% endfor %}
      <div class="text-center" style="margin-top: 1rem;">
        <a href="{{ url_for('transaction') }}" class="link-button">View all transactions</a>
      </div>
    </div>
    {% endif %}
  </div>
</body>
</html>
